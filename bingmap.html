<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>Add 50 pushpins</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
      <script type="text/javascript">
      var map = null;
      var places = [];
            
      function getMap()
      {
        map = new Microsoft.Maps.Map(document.getElementById('myMap'), {credentials: 'Amx6HKtetEO_AyjRNmnXMGm9lnf47JsB3MCFFjjLOmpoIuPh-v5VlMA_ti5lKj6K'});
        map.setView( {zoom:5}); 
      }
      
      function addPushpins()
      {
          var limit = 5; 
          var bounds=map.getBounds(); 
          latlon = bounds.getNorthwest(); 
          var lat = latlon.latitude - bounds.height/4; 
          var lon = latlon.longitude + bounds.width/4; 
          var latDiff =  bounds.height/2  ; 
          var lonDiff =  bounds.width/2; 
          for (var i = 0; i < limit; i++) {  
            var newLat = lat - (latDiff * Math.random());  
            var newLon = lon + (lonDiff * Math.random());
            places.push({lat: newLat, lon: newLon});
            var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(newLat, newLon), null); 
            map.entities.push(pushpin); 
          }
      }

      function addLines() {
            //latlon = map.getCenter(); 
            // var polyline = new Microsoft.Maps.Polyline([new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude-0.1),
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude-0.1), 
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude), 
            //                                             new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude), 
            //                                             new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude+0.1), 
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude+0.1)], null); 
            
            var points = places.map(p => new Microsoft.Maps.Location(p.lat, p.lon) )
            var polyline = new Microsoft.Maps.Polyline(points);
            // var polyline = new Microsoft.Maps.Polyline([new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude-0.1),
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude-0.1), 
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude), 
            //                                             new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude), 
            //                                             new Microsoft.Maps.Location(latlon.latitude-0.1, latlon.longitude+0.1), 
            //                                             new Microsoft.Maps.Location(latlon.latitude+0.1, latlon.longitude+0.1)], null); 
            
            
            
            map.entities.push(polyline);

      }

      
      </script>
   </head>
   <body onload="getMap();">
      <div id='myMap' style="position:relative; width:400px; height:400px;"></div>
      <div>
         <input type="button" value="Add Places" onclick="addPushpins();" />
         <input type="button" value="Add Lines" onclick="addLines();" />
      </div>
   </body>
</html>
      
